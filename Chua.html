<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lucky Orbs — RNG Game</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#7c3aed; --glass:rgba(255,255,255,0.06);
      --success:#10b981; --danger:#ef4444; --muted:rgba(255,255,255,0.6);
      font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:radial-gradient(1200px 600px at 10% 10%, rgba(124,58,237,0.12), transparent),
      radial-gradient(800px 400px at 90% 90%, rgba(16,185,129,0.06), transparent), var(--bg);
      color:#e6eef8; display:flex; align-items:center; justify-content:center; padding:32px;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    .wrap{width:100%; max-width:980px}

    header{display:flex; gap:16px; align-items:center; margin-bottom:18px}
    h1{margin:0; font-size:24px; letter-spacing:0.4px}
    p.lead{margin:0; color:var(--muted); font-size:13px}

    .grid{display:grid; grid-template-columns: 360px 1fr; gap:18px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent); border:1px solid rgba(255,255,255,0.04); padding:18px; border-radius:14px; box-shadow: 0 6px 30px rgba(2,6,23,0.6)}

    .panel{display:flex; flex-direction:column; gap:12px}
    .orb{width:140px; height:140px; border-radius:50%; background:linear-gradient(180deg,#111827 0%, #0b1220 100%); display:flex; align-items:center; justify-content:center; margin:8px auto; position:relative; box-shadow: inset 0 -10px 30px rgba(0,0,0,0.6), 0 6px 30px rgba(124,58,237,0.12)}
    .orb::after{content:''; position:absolute; inset:6px; border-radius:50%; background:conic-gradient(from 180deg at 50% 50%, rgba(124,58,237,0.12), transparent 60%);}

    .value{font-size:34px; font-weight:700; letter-spacing:1px}
    .rarity{font-weight:700; font-size:12px; padding:6px 10px; border-radius:999px; display:inline-block}

    button.btn{appearance:none; border:0; padding:10px 16px; border-radius:10px; font-weight:700; cursor:pointer}
    .btn-roll{background:linear-gradient(90deg,var(--accent),#4c1d95); color:white; box-shadow: 0 8px 30px rgba(124,58,237,0.18)}
    .btn-reset{background:transparent; color:var(--muted); border:1px solid rgba(255,255,255,0.04)}

    .stats{display:flex; gap:8px; flex-wrap:wrap}
    .stat{background:var(--glass); padding:8px 10px; border-radius:10px; min-width:110px}
    .muted{color:var(--muted); font-size:13px}

    .log{height:220px; overflow:auto; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); padding:12px; border-radius:10px; font-family:monospace; font-size:13px}

    footer{margin-top:14px; display:flex; justify-content:space-between; align-items:center; color:var(--muted); font-size:13px}

    /* rarity colors */
    .rar-common{background:rgba(255,255,255,0.04); color: #d1d5db}
    .rar-rare{background:rgba(99,102,241,0.12); color:#c7d2fe}
    .rar-epic{background:rgba(124,58,237,0.14); color:#ede9fe}
    .rar-legend{background:linear-gradient(90deg,#f59e0b,#ef4444); color:#1f2937}

    /* responsive */
    @media (max-width:880px){.grid{grid-template-columns:1fr;}.orb{margin:0 auto}}

    /* subtle animations */
    .spin{animation:spinAnim 1.2s cubic-bezier(.2,.9,.2,1)}
    @keyframes spinAnim{0%{transform:rotate(0) scale(1)}50%{transform:rotate(15deg) scale(1.02)}100%{transform:rotate(0) scale(1)}}

    .glow{box-shadow:0 0 40px rgba(124,58,237,0.18), inset 0 6px 28px rgba(124,58,237,0.06)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Lucky Orbs</h1>
        <p class="lead">A crispy little RNG web game — roll the orb, chase rarities, unlock streaks and beat your high score.</p>
      </div>
      <div style="margin-left:auto;text-align:right">
        <div class="muted">Made with ❤️ — No libraries, fully client-side</div>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <div class="panel">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="muted">Balance</div>
              <div style="font-size:20px;font-weight:800">₱ <span id="balance">0</span></div>
            </div>
            <div style="text-align:right">
              <div class="muted">High Score</div>
              <div style="font-weight:800"> <span id="highscore">0</span> pts</div>
            </div>
          </div>

          <div class="orb" id="orb">
            <div style="text-align:center">
              <div class="value" id="value">—</div>
              <div id="rarityBadge" class="rarity rar-common" style="margin-top:8px">—</div>
            </div>
          </div>

          <div style="display:flex;gap:10px;justify-content:center">
            <button class="btn btn-roll" id="rollBtn">ROLL (₱5)</button>
            <button class="btn btn-reset" id="resetBtn">Reset</button>
          </div>

          <div style="display:flex;gap:12px;align-items:center;justify-content:center;margin-top:8px">
            <div class="muted">Auto-roll</div>
            <label style="display:inline-flex;align-items:center;gap:8px">
              <input type="checkbox" id="autoCheck" />
            </label>
            <div class="muted">Speed</div>
            <input id="speed" type="range" min="200" max="2000" value="800" />
          </div>

          <div style="display:flex;gap:8px;justify-content:space-between;margin-top:12px;flex-wrap:wrap">
            <div class="stat"><div class="muted">Rolls</div><div id="rollCount">0</div></div>
            <div class="stat"><div class="muted">Best Streak</div><div id="bestStreak">0</div></div>
            <div class="stat"><div class="muted">Current Streak</div><div id="curStreak">0</div></div>
            <div class="stat"><div class="muted">Last Win</div><div id="lastWin">—</div></div>
          </div>

        </div>
      </section>

      <section class="card">
        <div class="panel">
          <h3 style="margin:0">Activity Log</h3>
          <div class="muted" style="font-size:13px">Recent rolls & outcomes</div>

          <div class="log" id="log"></div>

          <footer>
            <div>
              <div style="font-weight:700">How it works</div>
              <div class="muted">Roll costs ₱5. Rarities determine points earned. Legendary is rare — celebrate when it appears!</div>
            </div>
            <div style="text-align:right">
              <div class="muted">Seed: <span id="seedId">—</span></div>
            </div>
          </footer>
        </div>
      </section>
    </div>
  </div>

  <canvas id="confetti" style="position:fixed;inset:0;pointer-events:none;opacity:0;transition:opacity 300ms"></canvas>

  <script>
    // RNG Game logic — clean, accessible, and single-file.
    (()=>{
      const balanceEl = document.getElementById('balance')
      const highEl = document.getElementById('highscore')
      const valueEl = document.getElementById('value')
      const rarityEl = document.getElementById('rarityBadge')
      const orb = document.getElementById('orb')
      const rollBtn = document.getElementById('rollBtn')
      const resetBtn = document.getElementById('resetBtn')
      const logEl = document.getElementById('log')
      const rollCountEl = document.getElementById('rollCount')
      const bestStreakEl = document.getElementById('bestStreak')
      const curStreakEl = document.getElementById('curStreak')
      const lastWinEl = document.getElementById('lastWin')
      const seedIdEl = document.getElementById('seedId')
      const autoCheck = document.getElementById('autoCheck')
      const speed = document.getElementById('speed')

      const confettiCanvas = document.getElementById('confetti')
      const ctx = confettiCanvas.getContext('2d')
      let confettiPieces = []

      // persistent state
      const key = 'lucky-orbs-v1'
      let state = {
        balance: 50, // starter balance
        high: 0,
        rolls:0,
        bestStreak:0,
        curStreak:0,
        lastWin:'—',
        seed: Math.floor(Math.random()*1e9).toString(36).slice(0,6).toUpperCase()
      }

      // load
      try{ const saved = JSON.parse(localStorage.getItem(key)); if(saved) state = {...state,...saved} }catch(e){}
      balanceEl.textContent = state.balance
      highEl.textContent = state.high
      rollCountEl.textContent = state.rolls
      bestStreakEl.textContent = state.bestStreak
      curStreakEl.textContent = state.curStreak
      lastWinEl.textContent = state.lastWin
      seedIdEl.textContent = state.seed

      function save(){ localStorage.setItem(key, JSON.stringify(state)) }

      function rng(){ // returns 0..1 with a seeded-ish tweak using time + seed
        // Not cryptographically secure — purely for fun
        const t = performance.now()
        const s = state.seed.split('').reduce((a,c)=>a + c.charCodeAt(0), 0)
        const x = Math.sin(t*0.000021 + s) * 10000
        return x - Math.floor(x)
      }

      function rollOnce(){
        if(state.balance < 5) return pushLog('Not enough balance to roll.', 'warning')
        state.balance -= 5
        state.rolls += 1

        // main RNG value 1-100
        const r = Math.floor(rng()*100) + 1
        valueEl.textContent = r

        // determine rarity
        let rarity = 'Common', cls='rar-common', points = 1
        if(r === 100){ rarity='Mythic'; cls='rar-legend'; points = 150 }
        else if(r >= 95){ rarity='Legendary'; cls='rar-legend'; points = 50 }
        else if(r >= 85){ rarity='Epic'; cls='rar-epic'; points = 20 }
        else if(r >= 60){ rarity='Rare'; cls='rar-rare'; points = 6 }
        else { rarity='Common'; cls='rar-common'; points = 1 }

        // visual
        rarityEl.textContent = rarity
        rarityEl.className = 'rarity '+cls
        orb.classList.remove('glow')
        void orb.offsetWidth
        orb.classList.add('spin')
        setTimeout(()=>orb.classList.remove('spin'), 1200)

        // scoring
        const earned = points
        state.balance += earned

        // streaks
        if(['Epic','Legendary','Mythic'].includes(rarity)){
          state.curStreak += 1
          state.bestStreak = Math.max(state.bestStreak, state.curStreak)
          state.lastWin = `${rarity} (+${earned})`
        } else {
          state.curStreak = 0
        }

        // big celebrations
        if(rarity === 'Legendary' || rarity === 'Mythic'){
          orb.classList.add('glow')
          fireConfetti(r===100?120:80)
        }

        state.high = Math.max(state.high, state.balance)
        updateUI()
        save()

        pushLog(`#${state.rolls} rolled ${r} — ${rarity} (+${earned} pts)`, rarity)
      }

      function updateUI(){
        balanceEl.textContent = state.balance
        highEl.textContent = state.high
        rollCountEl.textContent = state.rolls
        bestStreakEl.textContent = state.bestStreak
        curStreakEl.textContent = state.curStreak
        lastWinEl.textContent = state.lastWin
      }

      function pushLog(text, kind){
        const node = document.createElement('div')
        node.textContent = text
        node.style.padding = '6px 0'
        if(kind === 'Legendary' || kind === 'Mythic' || kind === 'warning') node.style.fontWeight='700'
        logEl.prepend(node)
        // keep recent 200 lines
        while(logEl.childNodes.length > 200) logEl.removeChild(logEl.lastChild)
      }

      rollBtn.addEventListener('click', ()=>rollOnce())
      resetBtn.addEventListener('click', ()=>{
        if(!confirm('Reset progress and start fresh?')) return
        state = {balance:50,high:0,rolls:0,bestStreak:0,curStreak:0,lastWin:'—',seed:Math.floor(Math.random()*1e9).toString(36).slice(0,6).toUpperCase()}
        save(); updateUI(); seedIdEl.textContent = state.seed; logEl.innerHTML=''; pushLog('Progress reset — good luck!')
      })

      // auto-roll support
      let autoTimer = null
      autoCheck.addEventListener('change', ()=>{
        if(autoCheck.checked) startAuto() ; else stopAuto()
      })
      speed.addEventListener('input', ()=>{ if(autoCheck.checked) { stopAuto(); startAuto() } })
      function startAuto(){
        stopAuto()
        autoTimer = setInterval(()=>{ if(document.hidden) return; rollOnce() }, parseInt(speed.value))
      }
      function stopAuto(){ if(autoTimer) { clearInterval(autoTimer); autoTimer=null } }

      // confetti simple engine
      function resizeCanvas(){ confettiCanvas.width = innerWidth; confettiCanvas.height = innerHeight }
      window.addEventListener('resize', resizeCanvas)
      resizeCanvas()

      function fireConfetti(count=60){
        confettiCanvas.style.opacity = 1
        for(let i=0;i<count;i++) confettiPieces.push(createPiece())
        if(!window._confettiLoop) loopConfetti()
        setTimeout(()=>{ confettiCanvas.style.opacity = 0 }, 2200)
      }
      function createPiece(){
        return {
          x: Math.random()*confettiCanvas.width,
          y: -20 - Math.random()*200,
          vx: (Math.random()-0.5)*6,
          vy: 2+Math.random()*6,
          size: 6+Math.random()*10,
          rot: Math.random()*360,
          velRot: (Math.random()-0.5)*12,
          color: ['#f59e0b','#ef4444','#10b981','#7c3aed','#06b6d4'][Math.floor(Math.random()*5)]
        }
      }
      function loopConfetti(){
        window._confettiLoop = true
        const step = ()=>{
          ctx.clearRect(0,0,confettiCanvas.width,confettiCanvas.height)
          confettiPieces = confettiPieces.filter(p => p.y < confettiCanvas.height + 50)
          confettiPieces.forEach(p=>{
            p.x += p.vx; p.y += p.vy; p.vy += 0.08; p.rot += p.velRot
            ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.rot*Math.PI/180)
            ctx.fillStyle = p.color; ctx.fillRect(-p.size/2, -p.size/2, p.size, p.size*0.6)
            ctx.restore()
          })
          if(confettiPieces.length) requestAnimationFrame(step)
          else window._confettiLoop = false
        }
        requestAnimationFrame(step)
      }

      // accessibility & keyboard
      window.addEventListener('keydown', (e)=>{ if(e.key === ' ' || e.key === 'Enter') { e.preventDefault(); rollOnce() } })

      // initial hint
      pushLog(`Welcome! Starter balance ₱${state.balance}. Press ROLL or hit Space/Enter to play. Seed: ${state.seed}`)
      save()

    })();
  </script>
</body>
</html>
