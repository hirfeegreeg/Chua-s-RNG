<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Lucky Orbs — Cosmetics & Skins</title>
<meta name="description" content="Advanced RNG game with cosmetic orb skins, animated visuals, responsive layout, themes, shop with images, and improved UX." />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#071029; --card:#071827; --accent:#7c3aed; --accent-2:#06b6d4; --glass:rgba(255,255,255,0.04);
  --muted:rgba(255,255,255,0.66); --success:#10b981; --danger:#ef4444; --glass-2:rgba(255,255,255,0.02);
  --text:#e6eef8; --radius:14px; --max-width:1200px; --orb-size:220px;
  font-family:Inter, Poppins, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
}
[data-theme='dark']{ --bg:#071029; --card:#071827; --accent:#7c3aed; --accent-2:#06b6d4; --text:#e6eef8 }
[data-theme='midnight']{ --bg:#00121b; --card:#07132a; --accent:#06b6d4; --accent-2:#7c3aed; --text:#eaf6ff }
[data-theme='sunrise']{ --bg:#fff7ed; --card:#fff; --accent:#fb923c; --accent-2:#ef4444; --text:#0b1020 }

*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:linear-gradient(180deg,var(--bg) 0%, #03121a 100%);color:var(--text);display:flex;align-items:flex-start;justify-content:center;padding:24px}

.app{width:100%;max-width:var(--max-width)}
header{display:flex;gap:12px;align-items:center;margin-bottom:14px}
h1{margin:0;font-size:20px}
p.lead{margin:0;color:var(--muted);font-size:13px}

.layout{display:grid;grid-template-columns:320px 1fr 360px;gap:16px}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.015), transparent);border:1px solid rgba(255,255,255,0.04);padding:16px;border-radius:var(--radius);box-shadow:0 10px 40px rgba(2,6,23,0.6)}

.left .profile{display:flex;align-items:center;gap:12px}
.avatar{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,#0ea5a4,#7c3aed);display:flex;align-items:center;justify-content:center;font-weight:800}

.orb-wrap{display:flex;flex-direction:column;align-items:center;gap:14px}
.orb{width:var(--orb-size);height:var(--orb-size);border-radius:50%;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;background:radial-gradient(circle at 30% 25%, rgba(255,255,255,0.03), transparent 10%);box-shadow:0 30px 80px rgba(2,6,23,0.6)}
.orb .skin{position:absolute;inset:0;background-size:cover;background-position:center;transform-origin:center;transition:transform 600ms cubic-bezier(.2,.9,.2,1)}
.orb .overlay{position:absolute;inset:0;background:linear-gradient(180deg, rgba(0,0,0,0.08), rgba(0,0,0,0.18))}
.orb .center{position:relative;z-index:5;text-align:center}

.value{font-size:44px;font-weight:800;letter-spacing:1px}
.rarity{font-weight:800;font-size:13px;padding:6px 12px;border-radius:999px;display:inline-block;margin-top:8px}

.controls{display:flex;gap:10px;align-items:center}
.btn{appearance:none;border:0;padding:10px 14px;border-radius:10px;font-weight:800;cursor:pointer}
.btn-primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;box-shadow:0 14px 36px rgba(124,58,237,0.14)}
.btn-ghost{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.04)}

.shop-item{display:flex;gap:10px;align-items:center;padding:8px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent)}
.skin-thumb{width:64px;height:64px;border-radius:10px;overflow:hidden;flex-shrink:0;border:1px solid rgba(255,255,255,0.03)}
.skin-meta{flex:1}

.theme-switcher{display:flex;gap:8px;align-items:center}
.theme-dot{width:14px;height:14px;border-radius:999px;cursor:pointer;border:1px solid rgba(255,255,255,0.06)}

.log{height:240px;overflow:auto;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);padding:12px;border-radius:10px;font-family:monospace;font-size:13px}

.skin-list{display:grid;grid-template-columns:1fr;gap:8px;margin-top:8px}
.skin-actions{display:flex;gap:8px;align-items:center}

.badge{background:var(--glass);padding:6px 8px;border-radius:8px;font-weight:700}

/* responsive */
@media (max-width:1100px){.layout{grid-template-columns:1fr;}.orb{--orb-size:180px}}

/* animations */
.orb.spin .skin{animation:orbSpin 2.6s cubic-bezier(.2,.9,.2,1)}
@keyframes orbSpin{0%{transform:rotate(0) scale(1)}50%{transform:rotate(180deg) scale(1.03)}100%{transform:rotate(360deg) scale(1)}}

.glow{box-shadow:0 0 40px rgba(124,58,237,0.22), inset 0 8px 40px rgba(124,58,237,0.06)}

.skin-animated-1{background:conic-gradient(from 120deg at 50% 50%, rgba(124,58,237,0.12), rgba(6,182,212,0.12), rgba(124,58,237,0.12)); animation:flow 6s linear infinite}
.skin-animated-2{background:linear-gradient(120deg,#ff7a18,#af002d 40%, #3a1c71 100%); animation:flow 10s linear infinite}
@keyframes flow{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
</style>
</head>
<body data-theme="dark">
<div class="app">
<header>
  <div>
    <h1>Lucky Orbs — Skins & Cosmetics</h1>
    <p class="lead">Now with HIGH-RISK rolls: double-or-nothing, big wins & losses, and negative points!</p>
  </div>
  <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
    <div class="theme-switcher">
      <div title="Dark" class="theme-dot" style="background:linear-gradient(135deg,#0f1724,#0b1220)" data-theme="dark"></div>
      <div title="Midnight" class="theme-dot" style="background:linear-gradient(135deg,#00121b,#07132a)" data-theme="midnight"></div>
      <div title="Sunrise" class="theme-dot" style="background:linear-gradient(135deg,#fff7ed,#ffedd5)" data-theme="sunrise"></div>
    </div>
    <div style="display:flex;gap:8px;align-items:center">
      <button id="exportBtn" class="btn btn-ghost">Export</button>
      <button id="importBtn" class="btn btn-ghost">Import</button>
    </div>
  </div>
</header>

<div class="layout">
  <!-- LEFT -->
  <aside class="card left">
    <div class="profile">
      <div class="avatar" id="playerAvatar">U</div>
      <div>
        <div style="font-weight:800" id="playerName">You</div>
        <div class="muted">Balance: ₱<span id="balance">0</span></div>
      </div>
    </div>

    <hr style="border:none;height:1px;background:rgba(255,255,255,0.03);margin:12px 0;border-radius:2px">

    <div>
      <div class="muted">Achievements</div>
      <div class="skin-list" id="achGrid"></div>
    </div>

    <div style="margin-top:12px">
      <div class="muted">Upload Custom Skin</div>
      <input id="uploadSkin" type="file" accept="image/*" />
      <div style="margin-top:8px;font-size:13px" class="muted">Upload an image to create a custom orb skin. It will be added to your cosmetics.</div>
    </div>
  </aside>

  <!-- CENTER -->
  <main class="card center">
    <div class="orb-wrap">
      <div class="orb" id="orb">
        <div class="skin" id="orbSkin"></div>
        <div class="overlay"></div>
        <div class="center">
          <div class="value" id="value">—</div>
          <div id="rarityBadge" class="rarity rar-common">—</div>
        </div>
      </div>

      <div class="controls">
        <button id="rollBtn" class="btn btn-primary">ROLL (₱<span id="rollCostDisplay">5</span>)</button>
        <button id="multiBtn" class="btn btn-ghost">×10</button>
        <button id="autoBtn" class="btn btn-ghost">Auto</button>
        <select id="skinPicker" style="padding:8px;border-radius:8px;background:transparent;color:inherit;border:1px solid rgba(255,255,255,0.04)">
        </select>
      </div>

      <div style="display:flex;gap:12px;justify-content:space-between;width:100%;margin-top:10px">
        <div class="muted">Last Win: <span id="lastWin">—</span></div>
        <div class="muted">Seed: <span id="seedShort">—</span></div>
      </div>

      <div style="width:100%;margin-top:12px">
        <div class="muted">Activity Log</div>
        <div class="log" id="log"></div>
      </div>
    </div>
  </main>

  <!-- RIGHT -->
  <aside class="card right">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
      <div class="muted">Cosmetic Shop</div>
      <div class="muted">Owned: <span id="ownedCount">0</span></div>
    </div>

    <div id="shopList"></div>

    <hr style="border:none;height:1px;background:rgba(255,255,255,0.03);margin:12px 0;border-radius:2px">

    <div>
      <div class="muted">Leaderboard (Local)</div>
      <div id="leaderboard" style="margin-top:8px"></div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <input id="nameInput" placeholder="Your name" style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit" />
        <button id="submitScore" class="btn btn-primary">Submit</button>
      </div>
    </div>
  </aside>
</div>
</div>

<canvas id="confetti" style="position:fixed;inset:0;pointer-events:none;opacity:0;transition:opacity 300ms"></canvas>

<script>
(function(){
  const balanceEl = document.getElementById('balance');
  const valueEl = document.getElementById('value');
  const rarityEl = document.getElementById('rarityBadge');
  const orbEl = document.getElementById('orb');
  const orbSkin = document.getElementById('orbSkin');
  const rollBtn = document.getElementById('rollBtn');
  const multiBtn = document.getElementById('multiBtn');
  const autoBtn = document.getElementById('autoBtn');
  const skinPicker = document.getElementById('skinPicker');
  const shopList = document.getElementById('shopList');
  const logEl = document.getElementById('log');
  const seedShort = document.getElementById('seedShort');
  const ownedCountEl = document.getElementById('ownedCount');
  const uploadSkin = document.getElementById('uploadSkin');

  const confettiCanvas = document.getElementById('confetti');
  const ctx = confettiCanvas.getContext('2d');
  function resizeCanvas(){ confettiCanvas.width = innerWidth; confettiCanvas.height = innerHeight }
  window.addEventListener('resize', resizeCanvas); resizeCanvas();

  const KEY = 'lucky-orbs-cosmetics-v1';
  const LB_KEY = 'lucky-orbs-leaderboard-v1';

  const defaultState = {
    balance:200, high:0, rolls:0, bestStreak:0, curStreak:0, lastWin:'—',
    seed:(new Date().getTime() + Math.floor(Math.random()*1e9)).toString(36).slice(0,8),
    wins:0, rare:0, epic:0, legend:0,
    skins:[], activeSkin:'classic', auto:false, rollCost:5
  }

  let state = {};

  function load(){ try{ const saved=JSON.parse(localStorage.getItem(KEY)); state=saved?{...defaultState,...saved}:{...defaultState} }catch(e){ state={...defaultState} } }
  function save(){ localStorage.setItem(KEY, JSON.stringify(state)) }

  function rng(){ const s=state.seed.split('').reduce((a,c)=>a+c.charCodeAt(0),0); const t=performance.now(); const x=Math.sin(t*0.000021+s)*10000; return x-Math.floor(x) }

  // NEW RNG ROLL LOGIC with negatives & double-or-nothing
  function rollOnce(){
    if(state.balance < state.rollCost){ pushLog('Not enough coins to roll','warn'); return }
    state.balance -= state.rollCost;
    state.rolls += 1;
    const r = Math.floor(rng()*100)+1;
    let points = 0;
    let rarity='Common', cls='rar-common';
    
    // High-risk negative and double-or-nothing
    if(r>=98){ rarity='Mythic'; cls='rar-legend'; points=Math.floor(Math.random()*500)+200 } // huge win
    else if(r>=90){ rarity='Legendary'; cls='rar-legend'; points=Math.floor(Math.random()*150)+50 }
    else if(r>=75){ rarity='Epic'; cls='rar-epic'; points=Math.floor(Math.random()*50)+15 }
    else if(r>=50){ rarity='Rare'; cls='rar-rare'; points=Math.floor(Math.random()*10)+5 }
    else{ // Common roll can lose coins!
      points = -Math.floor(Math.random()*state.rollCost*1.5); // up to 1.5x roll cost lost
    }

    // 10% chance for double-or-nothing if positive
    if(points>0 && rng()<0.1){ points *=2; pushLog('Double or nothing bonus!','success') }
    
    state.balance += points;
    valueEl.textContent = r;
    rarityEl.textContent = rarity;
    rarityEl.className = 'rarity '+cls;

    state.lastWin = `${rarity} (${points>0?'+':'-'}${Math.abs(points)})`;
    pushLog(`#${state.rolls} rolled ${r} — ${rarity} (${points>0?'+':'-'}${Math.abs(points)})`, rarity);

    if(rarity==='Legendary'||rarity==='Mythic') fireConfetti(rarity==='Mythic'?150:90);

    orbEl.classList.add('spin'); setTimeout(()=>orbEl.classList.remove('spin'),2600);
    updateUI(); save();
    return {r,rarity,points};
  }

  function updateUI(){ balanceEl.textContent=state.balance; seedShort.textContent=state.seed.slice(0,6); document.getElementById('lastWin').textContent=state.lastWin; document.getElementById('rollCostDisplay').textContent=state.rollCost }

  function pushLog(txt, kind){ const node=document.createElement('div'); node.textContent=txt; node.style.padding='6px 0'; if(kind==='Legendary'||kind==='Mythic') node.style.fontWeight='900'; logEl.prepend(node); while(logEl.childNodes.length>300) logEl.removeChild(logEl.lastChild) }

  rollBtn.addEventListener('click', ()=>rollOnce());
  multiBtn.addEventListener('click', ()=>{ for(let i=0;i<10;i++) rollOnce() });

  load(); updateUI();
})();
</script>
</body>
</html>
